define(["nougat","underscore","jquery","backbone","BaseView"],function(e,t,n,r,i){"use strict";var s={hawk_service_timeout_error:"HAWK_SERVICE_TIMEOUT",fetchAndCallback:function(e,t,r){r&&this.startModuleLoadTimer();var i=n.get(e,t.form,n.proxy(function(e){t.callback.call(this,e,t),r&&this.recordModuleLoadTime(e.sys,r,e.data)},this)).fail(function(e){var t=e?e.getResponseHeader("location"):null;typeof t=="string"&&(window.location=t)});return i},simpleFetchAndRender:function(e,t,r,i,s,o){o&&this.startModuleLoadTimer(),n.ajax({url:e,type:"GET",cache:!1}).done(n.proxy(function(e){i.template=r,i.model.set(e),i.afterRender=function(e){n(t).removeClass("loading"),n(t).html(e),typeof s=="function"&&s(),n("body").trigger("viewLoaded",[i.template])},i.render(),o&&this.recordModuleLoadTime(i.model.get("sys"),o,e.data)},this)).fail(function(e){i.template=r,i.model.set({data:{error:!0,errorInfo:!0}}),n("body").trigger("viewLoaded",[i.template]),i.afterRender=function(e){n(t).removeClass("loading"),n(t).html(e)},i.render();var s=e?e.getResponseHeader("location"):null;typeof s=="string"&&(window.location=s)})},fetchAndRender:function(e,t,r,i){i&&this.startModuleLoadTimer();var s=n.get(e,t.form,n.proxy(function(e){var n=!0;t.callback.call(this,e,t),t.renderCheck&&typeof t.renderCheck=="function"&&(n=t.renderCheck(e)),n&&(r.template=t.template,r.model.set(e),r.render()),i&&this.recordModuleLoadTime(r.model.get("sys"),i,e.data)},this)).done(function(e){n("body").trigger("viewLoaded",[e.viewName])}).fail(function(e){var t=e?e.getResponseHeader("location"):null;typeof t=="string"&&(window.location=t)});return s},startModuleLoadTimer:function(){try{window.PAYPAL.analytics.Analytics.prototype.recordAjaxStartTime()}catch(e){}},recordModuleLoadTime:function(e,t,r){if(e){var i=window.PAYPAL.analytics.instance,s=i&&i.utils.queryStringToObject(e.tracking.fpti.dataString);s.page=t,s.e="im",s.pgrp="main:businessweb:home::main",t==="main:businessweb:home::main:activity-module::"&&(s.tssrq=r.moduleLoadStartTime,s.tssrs=r.moduleLoadEndTime),r.serviceError&&(s.erpg=this.hawk_service_timeout_error,s.eccd=r.serviceError),e.tracking.fpti.dataString=n.param(s),i.recordAjaxPerformanceData({sys:e})}},handleErrorScenarios:function(e,t){if(e&&e.data&&e.data.errorInfo){var r='<div class="row-fluid"><div class="error-wrap '+e.data.errorInfo.messageType+' clearfix"><span class="message-wrap"><span class="message">'+e.data.errorInfo.message+'</span></span><i class="icon"></i></div></div>';n(t).html(r)}else if(e===undefined||e.type=="redirect")window.location.href=e?e.url:window.location.href},updateDateModifiedFlag:function(e){this.dateModified||(this.dateModified=!0,this.applyFilter(e))},updateCurrencyFlag:function(e){this.currencyModified||(this.currencyModified=!0,this.applyFilter(e))},updateIncrementalFetch:function(e){this.applyFilter({incrementalFetch:!0})},showTabSpecificDateFilter:function(){n(".dateFilterWrap").hide(),n("#"+this.mainTab+"DateFilter").show()},convertDatesToUTC:function(e){var t=n("#datePattern").val().toUpperCase();e.fromdate&&(e.fromdate_utc=moment(e.fromdate,t).utc().format()),e.todate&&(e.todate_utc=moment(e.todate,t).utc().format())},appendDateInfo:function(e){var t=n("#datePattern").val().toUpperCase(),r=null,i=null;e.fromdate&&(r=moment(e.fromdate,t),r&&(e.fromdate_year=r.year(),e.fromdate_month=r.month(),e.fromdate_day=r.date())),e.todate&&(i=moment(e.todate,t),r&&(e.todate_year=i.year(),e.todate_month=i.month(),e.todate_day=i.date()))},updateMainFilterDropdownList:function(e,t,r){var i;r==="currency"?i={listLength:e.transactionsCurrenciesList.optionList.length,dropdownID:t+"-currency",spanID:t+"-currencySelectWrap",dropdownData:e.transactionsCurrenciesList}:i={listLength:e.transactionsTypesList.optionList.length,dropdownID:t+"-transaction-type",spanID:t+"-transaction-filter-select .dropdownWrapper",dropdownData:e.transactionsTypesList},n(i.dropdownID).html("");for(var s=0;s<i.listLength;s+=1){var o=i.dropdownData.optionList[s],u=n("<option>");o.optionValue===i.dropdownData.defaultOption?(n(i.spanID+" .dropdown .option-text").html(o.optionName),u.val(o.optionValue).text(o.optionName).appendTo(i.dropdownID).attr("selected","selected")):u.val(o.optionValue).text(o.optionName).appendTo(i.dropdownID)}e.fpti&&u.addClass("scTrack:"+o.optionValue);if(r==="currency"){var a=n(t+"-currencySelectWrap, "+t+"-transactionSelectWrap+.filter-text");i.listLength<=1?a.hide():a.show()}else{var f=n(t+"-transaction-filter-select");f.show()}},fptiRecordClick:function(e,t,n,r,i){window.PAYPAL&&window.PAYPAL.analytics&&window.PAYPAL.analytics.instance&&window.PAYPAL.analytics.instance.recordClick&&window.fpti&&(window.fpti.page=e,window.fpti.e="cl",window.fpti.pgrp=t,window.fpti.tmpl=n,window.fpti.toolName=i,window.fpti.link=r,window.PAYPAL.analytics.instance.recordClick())},fptiRecordImpression:function(e,t,n){window.PAYPAL&&window.PAYPAL.analytics&&window.PAYPAL.analytics.instance&&window.PAYPAL.analytics.instance.recordImpression&&window.fpti&&(window.fpti.page=e,window.fpti.e="im",window.fpti.pgrp=t,window.fpti.tmpl=n,window.PAYPAL.analytics.instance.recordImpression())},getParameterByName:function(e,t){var n,r;return e=e.replace(/[\[\]]/g,"\\$&"),n=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)"),r=n.exec(t),r?r[2]?decodeURIComponent(r[2].replace(/\+/g," ")):"":null}};return s});