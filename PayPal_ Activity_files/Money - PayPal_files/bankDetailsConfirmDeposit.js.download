var ACCOUNT_LOCKED="4030";define(["jquery","backbone","BaseView","widget/theoverpanel","widget/alertMsg","widget/validateForm","backboneSyphon"],function(e,t,n,r,i,s){"use strict";var o=n.extend({el:"#confirmDepositPage",isBankDisabled:!1,template:"bank/overpanel/bankDetailsConfirmDeposit",events:{"click .removeBank":"showDeleteBankAlert","click .confirmDeposits .confirmDeposit":"confirmDeposits","click .addBankConfirmDeposit .close":"closeOverpanel","click .bankDetailsConfirmCode .close":"closeOverpanel"},afterRender:function(){this.formView=new s({el:'form[name="confirmDeposits"]'})},initialize:function(){r.setContent(this),this.setElement(this.$el).render()},closeOverpanel:function(e){this.isBankDisabled===!0&&(e.preventDefault(),t.trigger("closeAddBankOverpanel"),t.trigger("renderBanks"))},confirmDeposits:function(e){e.preventDefault(),t.trigger("toggleLoading",!0);var n=this.model.get("fiId"),r;r=r||new t.Model({fiId:n}),r.url=t.history.options.root+"confirmDeposits",this.listenToOnce(r,"sync",this.submitSuccess),this.listenToOnce(r,"error",this.submitError),r.save({currency:this.model.get("currency"),deposit1:this.$('input[name="deposit1"]').val(),deposit2:this.$('input[name="deposit2"]').val()})},showDeleteBankAlert:function(e){e.preventDefault(),this.alertView.showAlert("deleteBank",this.deleteBank.bind(this))},deleteBank:function(){t.trigger("toggleLoading",!0);var e=this.model.get("fiId"),n=new t.Model({fiId:e});n.set({id:e});var r=t.history.options.root+"banks/"+e;n.url=r,this.listenToOnce(n,"destroy",this.submitSuccess),this.listenToOnce(n,"error",this.submitError),n.destroy({wait:!0})},submitSuccess:function(e,n){t.trigger("toggleLoading",!1),t.trigger("closeAddBankOverpanel"),t.trigger("renderBanks")},submitError:function(e,n,r){t.trigger("toggleLoading",!1),n.error.code==="MAXED_RND_DEPOSIT_TRIES"&&(this.isBankDisabled=!0,this.$el.find("form input").attr("disabled","disabled")),this.showServiceErrorMsg(r)},showServiceErrorMsg:function(e){this.alertMsg=this.alertMsg||new i,this.removeServiceErrorMsg(),this.$el.find(".overpanel-header").after(this.alertMsg.setMessage(e).el)},removeServiceErrorMsg:function(){this.$(".alertMsg").remove()}});return o});