define(["jquery","jqueryUI"],function(e){"use strict";e.widget("pp.textField",{_create:function(){this._getElements(),this._addListeners(),this._load()},_getElements:function(){this.elements={},this.elements.parent=this.element,this.elements.input=this.element.find("input, textarea"),this.elements.helpErrors=this.element.find(".help-error"),this.elements.helpInformation=this.element.find(".help-information")},_addListeners:function(){this.elements.input.bind("focus",e.proxy(this._focus,this)),this.elements.input.bind("blur",e.proxy(this._blur,this)),this.elements.input.bind("complete",e.proxy(function(){this.closeBubble();var e=this.elements.input[0],t=this.validateField(e);t.valid?(this.elements.parent.removeClass("hasError"),this.elements.input.attr("aria-invalid","false")):(this.elements.parent.addClass("hasError"),this.elements.input.attr("aria-invalid","true"))},this)),this.elements.input.bind("error",e.proxy(this.openError,this))},_load:function(){this.elements.input.val()?this.elements.input.addClass("userText"):this.elements.input.removeClass("userText")},_blur:function(){this._load(),this.closeBubble();var e=this.elements.input[0],t=this.validateField(e);this._emptyFieldRule(t)},_emptyFieldRule:function(e){!e.valid&&e.error!=="valueMissing"?(this.elements.parent.addClass("hasError"),this.elements.input.attr("aria-invalid","true")):(this.elements.parent.removeClass("hasError"),this.elements.input.attr("aria-invalid","false"))},_focus:function(e){this.closeAllBubble();var t=this.elements.parent.hasClass("hasError");t?this.openError():this.openHelp()},openError:function(){var e=this.elements.input.attr("id");e&&e.length>0&&this.elements.input.attr("aria-describedby",e+"-help-error"),this.elements.helpErrors.addClass("open")},openHelp:function(e){var t=this.elements.input.attr("id");t&&t.length>0&&this.elements.input.attr("aria-describedby",t+"-help-information"),this.elements.helpInformation.addClass("open")},closeBubble:function(){var e=this.elements.input.attr("id");e&&e.length>0&&this.elements.input.removeAttr("aria-describedby"),this.elements.helpErrors.removeClass("open"),this.elements.helpInformation.removeClass("open")},closeAllBubble:function(){e("p.open, div.open").removeClass("open")},validateField:function(e){if(e.checkValidity){if(!e.checkValidity()){var t="";for(t in e.validity)if(e.validity[t]===!0&&t!=="valid")return{valid:!1,error:t}}}else{var n={valueMissing:this.processRequired(),typeMismatch:!0,patternMismatch:this.processPattern(),rangeUnderflow:!0,rangeOverflow:!0,customError:!0};if(!n.valueMissing)return{valid:!1,error:"valueMissing"};if(!n.patternMismatch)return{valid:!1,error:"patternMismatch"}}return{valid:!0}},processRequired:function(){if(typeof this.elements.input.attr("required")!="undefined"){var t=this.elements.input.val();return t!==null&&e.trim(t).length>0?!0:!1}return!0},processPattern:function(){var e=this.elements.input;if(!e.attr("pattern"))return!0;var t=new RegExp(e.attr("pattern"),"g");return t.test(e.val())}})});