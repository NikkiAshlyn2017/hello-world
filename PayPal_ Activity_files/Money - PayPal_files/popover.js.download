define(["jquery","BaseView","lib/business/businessHelper"],function(e,t,n){"use strict";function r(e,t,n){var r=new Date;r.setTime(r.getTime()+n*24*60*60*1e3);var i="expires="+r.toUTCString();document.cookie=e+"="+t+"; "+i}function i(e){var t=e+"=",n=document.cookie.split(";");for(var r=0;r<n.length;r++){var i=n[r];while(i.charAt(0)===" ")i=i.substring(1);if(i.indexOf(t)===0)return i.substring(t.length,i.length)}return""}var s=730,o=27,u=24,a=8,f=t.extend({el:"body",template:"widget/popover",events:{"click .pulse":"togglePopover","click .the-popover":"togglePopover","click a.dismiss-popover":"dismissPopover"},pageName:"common-popover",templateName:null,impressionRecorded:!1,recordFirstImpression:function(){var e="main:businessweb:home::main:"+this.pageName+":discovered:",t="main:businessweb:home::main";n.fptiRecordImpression(e,t,this.templateName),this.impressionRecorded=!0},recordDismissImpression:function(){var e="main:businessweb:home::main:"+this.pageName+":dismissed:",t="main:businessweb:home::main";n.fptiRecordImpression(e,t,this.templateName)},togglePopover:function(t){this.impressionRecorded||this.recordFirstImpression(),e(".the-popover").toggleClass("hidden")},dismissPopover:function(e){r("dismissPopover","true",s),this.$(".the-popover-container").add(".pulse").remove(),this.recordDismissImpression()},alignPopover:function(e){var t=this.$(".the-popover-container"),n=e.offset(),r={top:n.top+o,left:n.left-u},i=n.left-r.left+e.outerWidth()/2;t.removeClass("hidden").css(r).find(".arrow").css({left:i-a})},initialize:function(e,t){var n=this.$(e);if(i("dismissPopover")==="true")return;t.pageName&&(this.pageName=t.pageName),t.template&&(this.template=t.template),n.before('<div class="pulse"></div>'),this.alignPopover(n),window.onresize=function(){this.alignPopover(n)}.bind(this)}});return f});