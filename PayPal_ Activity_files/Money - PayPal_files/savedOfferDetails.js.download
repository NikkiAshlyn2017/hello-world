define(["jquery","backbone","BaseView","model/savedOffer","lib/business/businessHelper","widget/checkbox"],function(e,t,n,r,i){"use strict";var s=n.extend({el:".modalView",template:"money/inc/savedOfferDetails",events:{"click a.termsLink":"showOfferTerms","click a.offerBacklink":"hideOfferTerms","click #offerStatus":"updateOffer","click #deleteOffer":"deleteOffer","click #deleteYes":"deleteConfirmHandler","click #deleteNo":"deleteOfferNo"},initialize:function(e){},beforeRender:function(){},afterRender:function(){this.$(".ppCheckbox").checkbox()},showOfferTerms:function(t){t.preventDefault();var n="main:businessweb:money:savedOffers:main:viewOffer:tandc",r="main:businessweb:::money",s="bizexpnodeweb/public/templates/money/inc/savedOfferDetails.dust",o=null;i.fptiRecordClick(n,r,s,o),e(".offerTermsDetails, .savedofferDetails").toggle()},hideOfferTerms:function(t){t.preventDefault(),e(".offerTermsDetails, .savedofferDetails").toggle()},updateOffer:function(n){n.preventDefault(),this.status=e(n.currentTarget).is(":checked");var s="main:businessweb:money:savedOffers:main:viewOffer:",o="main:businessweb:::money",u="bizexpnodeweb/public/templates/money/inc/savedOfferDetails.dust",a=this.status?"link_name: nextPurchaseTrue":"link_name: nextPurchaseFalse";i.fptiRecordClick(s,o,u,a),this.savedOfferModel=new r,this.savedOfferModel.url=t.history.options.root+"money/savedOffer/"+this.model.get("fiId"),this.listenToOnce(this.savedOfferModel,"sync",this.updateOfferSuccess),this.listenToOnce(this.savedOfferModel,"error",this.updateOfferError),this.savedOfferModel.save({fiId:this.model.get("fiId"),isActive:this.status})},updateOfferSuccess:function(e,t){t&&t.updated?this.collection.set("state",this.status?"ready_to_use":"inactive"):this.collection.set("state",this.model.get("state"))},updateOfferError:function(){this.collection.set("state",this.model.get("state"))},deleteConfirmHandler:function(e){e.preventDefault();var n="main:businessweb:money:savedOffers:main:deleteOffer:",s="main:businessweb:::money",o="bizexpnodeweb/public/templates/money/inc/savedOfferDetails.dust",u="link_name: deleted";i.fptiRecordClick(n,s,o,u),this.savedOfferModel=new r,this.savedOfferModel.url=t.history.options.root+"money/savedOffer/"+this.model.get("fiId"),this.listenToOnce(this.savedOfferModel,"sync",this.deleteOfferSuccess),this.listenToOnce(this.savedOfferModel,"error",this.deleteOfferError),this.savedOfferModel.fetch()},deleteOffer:function(t){t.preventDefault(),e(".deleteConfPage, .savedofferDetails").toggle()},deleteOfferNo:function(t){t.preventDefault(),e(".deleteConfPage, .savedofferDetails").toggle()},deleteOfferSuccess:function(){t.trigger("removeAndReloadOffers",this.model.get("fiId"))},deleteOfferError:function(){var e="main:businessweb:money:savedOffers:main:deleteOffer:error",n="main:businessweb:::money",r="bizexpnodeweb/public/templates/money/inc/savedOfferDetails.dust",s=null;i.fptiRecordClick(e,n,r,s),t.trigger("removeAndReloadOffers",this.model.get("fiId"))}});return s});