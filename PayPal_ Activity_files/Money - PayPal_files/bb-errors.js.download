define(["backbone"],function(e){"use strict";var t=e.sync;e.sync=function(e,n,r){var i=r.success;r.success=function(e){if(e.error){e.error.code==="captcha"?n.trigger("captcha",n,e,e.error.captcha):e.error.code==="authRequired"?window.location=e.data.location:e.error.message&&n.trigger("error",n,e,e.error.message),n.trigger("sync-error");return}i(e)},r.error=function(e){e.error&&e.error.code==="authRequired"&&n.trigger("error",n,e,$("body").data("genericerror"));if(e.status==500){n.trigger("error");return}};var s=$("body").data("token");r.beforeSend=function(e){e.setRequestHeader("X-CSRF-Token",s)},t(e,n,r)}});