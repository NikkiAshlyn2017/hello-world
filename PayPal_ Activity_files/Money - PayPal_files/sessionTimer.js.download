define(["jquery","underscore","BaseView","backbone","widget/theoverpanel"],function(e,t,n,r,i){"use strict";var s=n.extend({el:"#overpanel",template:"widget/confirmSession",confirmationTimer:null,confirmationTimerLimit:84e4,expirationTimer:null,expirationTimerLimit:9e5,loginRedirectPath:"/login",extendSessionUrl:function(){return r.history.options.root+"extendSession"},events:{"click .reLogIn":"reLogIn","click .extendSession":function(e){i.hideOverpanel(),this.extendSession(e)}},initialize:function(){this.model=new r.Model({hideClose:!0}),e('[data-trigger="startSessionTimer"]').click(e.proxy(this.startSessionTimer,this,{isTrigger:!0}))},initializeTimers:function(){window.clearTimeout(this.confirmationTimer),window.clearTimeout(this.expirationTimer),this.confirmationTimer=window.setTimeout(e.proxy(function(){this.confirmSession()},this),this.confirmationTimerLimit),this.expirationTimer=window.setTimeout(e.proxy(function(){window.location=this.loginRedirectPath},this),this.expirationTimerLimit)},stopTimers:function(){window.clearTimeout(this.confirmationTimer),window.clearTimeout(this.expirationTimer)},extendSession:function(t){e.ajax({url:this.extendSessionUrl(),context:this,dataType:"json"}).fail(function(e){t.returnValue=!0,window.location.href=this.loginRedirectPath});if(!t.isTrigger)return this.stopTimers(),t.stopPropagation(),!1},startSessionTimer:function(t){this.initializeTimers(),e.ajax({url:this.extendSessionUrl(),context:this,dataType:"json"}).fail(function(e){t.returnValue=!0,window.location.href=this.loginRedirectPath});if(!t.isTrigger)return t.stopPropagation(),!1},confirmSession:function(){i.canUseEsc=!0,i.setContent(this)}});return s});